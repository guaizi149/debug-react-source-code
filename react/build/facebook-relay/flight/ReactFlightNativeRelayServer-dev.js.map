{"version":3,"file":"ReactFlightNativeRelayServer-dev.js","sources":["../../../packages/shared/ReactSharedInternals.js","../../../packages/shared/consoleWithStackDev.js","../../../packages/shared/hasOwnProperty.js","../../../packages/shared/isArray.js","../../../packages/react-server-native-relay/src/ReactFlightNativeRelayServerHostConfig.js","../../../packages/shared/ReactSymbols.js","../../../packages/react-server/src/ReactFlightServer.js","../../../packages/react-server-native-relay/src/ReactFlightNativeRelayServer.js"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport * as React from 'react';\n\nconst ReactSharedInternals =\n  React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n\nexport default ReactSharedInternals;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\n\nlet suppressWarning = false;\nexport function setSuppressWarning(newSuppressWarning) {\n  if (__DEV__) {\n    suppressWarning = newSuppressWarning;\n  }\n}\n\n// In DEV, calls to console.warn and console.error get replaced\n// by calls to these methods by a Babel plugin.\n//\n// In PROD (or in packages without access to React internals),\n// they are left as they are instead.\n\nexport function warn(format, ...args) {\n  if (__DEV__) {\n    if (!suppressWarning) {\n      printWarning('warn', format, args);\n    }\n  }\n}\n\nexport function error(format, ...args) {\n  if (__DEV__) {\n    if (!suppressWarning) {\n      printWarning('error', format, args);\n    }\n  }\n}\n\nfunction printWarning(level, format, args) {\n  // When changing this logic, you might want to also\n  // update consoleWithStackDev.www.js as well.\n  if (__DEV__) {\n    const ReactDebugCurrentFrame = ReactSharedInternals.ReactDebugCurrentFrame;\n    const stack = ReactDebugCurrentFrame.getStackAddendum();\n    if (stack !== '') {\n      format += '%s';\n      args = args.concat([stack]);\n    }\n\n    const argsWithFormat = args.map(item => '' + item);\n    // Careful: RN currently depends on this prefix\n    argsWithFormat.unshift('Warning: ' + format);\n    // We intentionally don't use spread (or .apply) directly because it\n    // breaks IE9: https://github.com/facebook/react/issues/13610\n    // eslint-disable-next-line react-internal/no-production-logging\n    Function.prototype.apply.call(console[level], console, argsWithFormat);\n  }\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\nexport default hasOwnProperty;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\ndeclare function isArray(a: mixed): boolean %checks(Array.isArray(a));\n\nconst isArrayImpl = Array.isArray;\n\n// eslint-disable-next-line no-redeclare\nfunction isArray(a: mixed): boolean {\n  return isArrayImpl(a);\n}\n\nexport default isArray;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {RowEncoding, JSONValue} from './ReactFlightNativeRelayProtocol';\nimport type {Request, ReactModel} from 'react-server/src/ReactFlightServer';\nimport hasOwnProperty from 'shared/hasOwnProperty';\nimport isArray from 'shared/isArray';\nimport JSResourceReferenceImpl from 'JSResourceReferenceImpl';\n\nexport type ModuleReference<T> = JSResourceReferenceImpl<T>;\n\nimport type {\n  Destination,\n  BundlerConfig,\n  ModuleMetaData,\n} from 'ReactFlightNativeRelayServerIntegration';\n\nimport {resolveModelToJSON} from 'react-server/src/ReactFlightServer';\n\nimport {\n  emitRow,\n  close,\n  resolveModuleMetaData as resolveModuleMetaDataImpl,\n} from 'ReactFlightNativeRelayServerIntegration';\n\nexport type {\n  Destination,\n  BundlerConfig,\n  ModuleMetaData,\n} from 'ReactFlightNativeRelayServerIntegration';\n\nexport function isModuleReference(reference: Object): boolean {\n  return reference instanceof JSResourceReferenceImpl;\n}\n\nexport type ModuleKey = ModuleReference<any>;\n\nexport function getModuleKey(reference: ModuleReference<any>): ModuleKey {\n  // We use the reference object itself as the key because we assume the\n  // object will be cached by the bundler runtime.\n  return reference;\n}\n\nexport function resolveModuleMetaData<T>(\n  config: BundlerConfig,\n  resource: ModuleReference<T>,\n): ModuleMetaData {\n  return resolveModuleMetaDataImpl(config, resource);\n}\n\nexport type Chunk = RowEncoding;\n\nexport function processErrorChunk(\n  request: Request,\n  id: number,\n  message: string,\n  stack: string,\n): Chunk {\n  return [\n    'E',\n    id,\n    {\n      message,\n      stack,\n    },\n  ];\n}\n\nfunction convertModelToJSON(\n  request: Request,\n  parent: {+[key: string]: ReactModel} | $ReadOnlyArray<ReactModel>,\n  key: string,\n  model: ReactModel,\n): JSONValue {\n  const json = resolveModelToJSON(request, parent, key, model);\n  if (typeof json === 'object' && json !== null) {\n    if (isArray(json)) {\n      const jsonArray: Array<JSONValue> = [];\n      for (let i = 0; i < json.length; i++) {\n        jsonArray[i] = convertModelToJSON(request, json, '' + i, json[i]);\n      }\n      return jsonArray;\n    } else {\n      const jsonObj: {[key: string]: JSONValue} = {};\n      for (const nextKey in json) {\n        if (hasOwnProperty.call(json, nextKey)) {\n          jsonObj[nextKey] = convertModelToJSON(\n            request,\n            json,\n            nextKey,\n            json[nextKey],\n          );\n        }\n      }\n      return jsonObj;\n    }\n  }\n  return json;\n}\n\nexport function processModelChunk(\n  request: Request,\n  id: number,\n  model: ReactModel,\n): Chunk {\n  const json = convertModelToJSON(request, {}, '', model);\n  return ['J', id, json];\n}\n\nexport function processModuleChunk(\n  request: Request,\n  id: number,\n  moduleMetaData: ModuleMetaData,\n): Chunk {\n  // The moduleMetaData is already a JSON serializable value.\n  return ['M', id, moduleMetaData];\n}\n\nexport function processSymbolChunk(\n  request: Request,\n  id: number,\n  name: string,\n): Chunk {\n  return ['S', id, name];\n}\n\nexport function scheduleWork(callback: () => void) {\n  callback();\n}\n\nexport function flushBuffered(destination: Destination) {}\n\nexport function beginWriting(destination: Destination) {}\n\nexport function writeChunk(destination: Destination, chunk: Chunk): boolean {\n  emitRow(destination, chunk);\n  return true;\n}\n\nexport function completeWriting(destination: Destination) {}\n\nexport {close};\n\nexport function closeWithError(destination: Destination, error: mixed): void {\n  close(destination);\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n// ATTENTION\n// When adding new symbols to this file,\n// Please consider also adding to 'react-devtools-shared/src/backend/ReactSymbols'\n\n// The Symbol used to tag the ReactElement-like types. If there is no native Symbol\n// nor polyfill, then a plain number is used for performance.\nexport let REACT_ELEMENT_TYPE = 0xeac7;\nexport let REACT_PORTAL_TYPE = 0xeaca;\nexport let REACT_FRAGMENT_TYPE = 0xeacb;\nexport let REACT_STRICT_MODE_TYPE = 0xeacc;\nexport let REACT_PROFILER_TYPE = 0xead2;\nexport let REACT_PROVIDER_TYPE = 0xeacd;\nexport let REACT_CONTEXT_TYPE = 0xeace;\nexport let REACT_FORWARD_REF_TYPE = 0xead0;\nexport let REACT_SUSPENSE_TYPE = 0xead1;\nexport let REACT_SUSPENSE_LIST_TYPE = 0xead8;\nexport let REACT_MEMO_TYPE = 0xead3;\nexport let REACT_LAZY_TYPE = 0xead4;\nexport let REACT_SCOPE_TYPE = 0xead7;\nexport let REACT_OPAQUE_ID_TYPE = 0xeae0;\nexport let REACT_DEBUG_TRACING_MODE_TYPE = 0xeae1;\nexport let REACT_OFFSCREEN_TYPE = 0xeae2;\nexport let REACT_LEGACY_HIDDEN_TYPE = 0xeae3;\nexport let REACT_CACHE_TYPE = 0xeae4;\n\nif (typeof Symbol === 'function' && Symbol.for) {\n  const symbolFor = Symbol.for;\n  REACT_ELEMENT_TYPE = symbolFor('react.element');\n  REACT_PORTAL_TYPE = symbolFor('react.portal');\n  REACT_FRAGMENT_TYPE = symbolFor('react.fragment');\n  REACT_STRICT_MODE_TYPE = symbolFor('react.strict_mode');\n  REACT_PROFILER_TYPE = symbolFor('react.profiler');\n  REACT_PROVIDER_TYPE = symbolFor('react.provider');\n  REACT_CONTEXT_TYPE = symbolFor('react.context');\n  REACT_FORWARD_REF_TYPE = symbolFor('react.forward_ref');\n  REACT_SUSPENSE_TYPE = symbolFor('react.suspense');\n  REACT_SUSPENSE_LIST_TYPE = symbolFor('react.suspense_list');\n  REACT_MEMO_TYPE = symbolFor('react.memo');\n  REACT_LAZY_TYPE = symbolFor('react.lazy');\n  REACT_SCOPE_TYPE = symbolFor('react.scope');\n  REACT_OPAQUE_ID_TYPE = symbolFor('react.opaque.id');\n  REACT_DEBUG_TRACING_MODE_TYPE = symbolFor('react.debug_trace_mode');\n  REACT_OFFSCREEN_TYPE = symbolFor('react.offscreen');\n  REACT_LEGACY_HIDDEN_TYPE = symbolFor('react.legacy_hidden');\n  REACT_CACHE_TYPE = symbolFor('react.cache');\n}\n\nconst MAYBE_ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\nconst FAUX_ITERATOR_SYMBOL = '@@iterator';\n\nexport function getIteratorFn(maybeIterable: ?any): ?() => ?Iterator<*> {\n  if (maybeIterable === null || typeof maybeIterable !== 'object') {\n    return null;\n  }\n  const maybeIterator =\n    (MAYBE_ITERATOR_SYMBOL && maybeIterable[MAYBE_ITERATOR_SYMBOL]) ||\n    maybeIterable[FAUX_ITERATOR_SYMBOL];\n  if (typeof maybeIterator === 'function') {\n    return maybeIterator;\n  }\n  return null;\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {Dispatcher as DispatcherType} from 'react-reconciler/src/ReactInternalTypes';\nimport type {\n  Destination,\n  Chunk,\n  BundlerConfig,\n  ModuleMetaData,\n  ModuleReference,\n  ModuleKey,\n} from './ReactFlightServerConfig';\n\nimport {\n  scheduleWork,\n  beginWriting,\n  writeChunk,\n  completeWriting,\n  flushBuffered,\n  close,\n  closeWithError,\n  processModelChunk,\n  processModuleChunk,\n  processSymbolChunk,\n  processErrorChunk,\n  resolveModuleMetaData,\n  getModuleKey,\n  isModuleReference,\n} from './ReactFlightServerConfig';\n\nimport {\n  REACT_ELEMENT_TYPE,\n  REACT_FORWARD_REF_TYPE,\n  REACT_FRAGMENT_TYPE,\n  REACT_LAZY_TYPE,\n  REACT_MEMO_TYPE,\n} from 'shared/ReactSymbols';\n\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\nimport invariant from 'shared/invariant';\nimport isArray from 'shared/isArray';\n\ntype ReactJSONValue =\n  | string\n  | boolean\n  | number\n  | null\n  | $ReadOnlyArray<ReactJSONValue>\n  | ReactModelObject;\n\nexport type ReactModel =\n  | React$Element<any>\n  | string\n  | boolean\n  | number\n  | null\n  | Iterable<ReactModel>\n  | ReactModelObject;\n\ntype ReactModelObject = {+[key: string]: ReactModel};\n\ntype Segment = {\n  id: number,\n  model: ReactModel,\n  ping: () => void,\n};\n\nexport type Request = {\n  destination: Destination,\n  bundlerConfig: BundlerConfig,\n  cache: Map<Function, mixed>,\n  nextChunkId: number,\n  pendingChunks: number,\n  pingedSegments: Array<Segment>,\n  completedModuleChunks: Array<Chunk>,\n  completedJSONChunks: Array<Chunk>,\n  completedErrorChunks: Array<Chunk>,\n  writtenSymbols: Map<Symbol, number>,\n  writtenModules: Map<ModuleKey, number>,\n  onError: (error: mixed) => void,\n  flowing: boolean,\n  toJSON: (key: string, value: ReactModel) => ReactJSONValue,\n};\n\nconst ReactCurrentDispatcher = ReactSharedInternals.ReactCurrentDispatcher;\n\nfunction defaultErrorHandler(error: mixed) {\n  console['error'](error); // Don't transform to our wrapper\n}\n\nexport function createRequest(\n  model: ReactModel,\n  destination: Destination,\n  bundlerConfig: BundlerConfig,\n  onError: void | ((error: mixed) => void),\n): Request {\n  const pingedSegments = [];\n  const request = {\n    destination,\n    bundlerConfig,\n    cache: new Map(),\n    nextChunkId: 0,\n    pendingChunks: 0,\n    pingedSegments: pingedSegments,\n    completedModuleChunks: [],\n    completedJSONChunks: [],\n    completedErrorChunks: [],\n    writtenSymbols: new Map(),\n    writtenModules: new Map(),\n    onError: onError === undefined ? defaultErrorHandler : onError,\n    flowing: false,\n    toJSON: function(key: string, value: ReactModel): ReactJSONValue {\n      return resolveModelToJSON(request, this, key, value);\n    },\n  };\n  request.pendingChunks++;\n  const rootSegment = createSegment(request, model);\n  pingedSegments.push(rootSegment);\n  return request;\n}\n\nfunction attemptResolveElement(\n  type: any,\n  key: null | React$Key,\n  ref: mixed,\n  props: any,\n): ReactModel {\n  if (ref !== null && ref !== undefined) {\n    // When the ref moves to the regular props object this will implicitly\n    // throw for functions. We could probably relax it to a DEV warning for other\n    // cases.\n    invariant(\n      false,\n      'Refs cannot be used in server components, nor passed to client components.',\n    );\n  }\n  if (typeof type === 'function') {\n    // This is a server-side component.\n    return type(props);\n  } else if (typeof type === 'string') {\n    // This is a host element. E.g. HTML.\n    return [REACT_ELEMENT_TYPE, type, key, props];\n  } else if (typeof type === 'symbol') {\n    if (type === REACT_FRAGMENT_TYPE) {\n      // For key-less fragments, we add a small optimization to avoid serializing\n      // it as a wrapper.\n      // TODO: If a key is specified, we should propagate its key to any children.\n      // Same as if a server component has a key.\n      return props.children;\n    }\n    // This might be a built-in React component. We'll let the client decide.\n    // Any built-in works as long as its props are serializable.\n    return [REACT_ELEMENT_TYPE, type, key, props];\n  } else if (type != null && typeof type === 'object') {\n    if (isModuleReference(type)) {\n      // This is a reference to a client component.\n      return [REACT_ELEMENT_TYPE, type, key, props];\n    }\n    switch (type.$$typeof) {\n      case REACT_FORWARD_REF_TYPE: {\n        const render = type.render;\n        return render(props, undefined);\n      }\n      case REACT_MEMO_TYPE: {\n        return attemptResolveElement(type.type, key, ref, props);\n      }\n    }\n  }\n  invariant(\n    false,\n    'Unsupported server component type: %s',\n    describeValueForErrorMessage(type),\n  );\n}\n\nfunction pingSegment(request: Request, segment: Segment): void {\n  const pingedSegments = request.pingedSegments;\n  pingedSegments.push(segment);\n  if (pingedSegments.length === 1) {\n    scheduleWork(() => performWork(request));\n  }\n}\n\nfunction createSegment(request: Request, model: ReactModel): Segment {\n  const id = request.nextChunkId++;\n  const segment = {\n    id,\n    model,\n    ping: () => pingSegment(request, segment),\n  };\n  return segment;\n}\n\nfunction serializeByValueID(id: number): string {\n  return '$' + id.toString(16);\n}\n\nfunction serializeByRefID(id: number): string {\n  return '@' + id.toString(16);\n}\n\nfunction escapeStringValue(value: string): string {\n  if (value[0] === '$' || value[0] === '@') {\n    // We need to escape $ or @ prefixed strings since we use those to encode\n    // references to IDs and as special symbol values.\n    return '$' + value;\n  } else {\n    return value;\n  }\n}\n\nfunction isObjectPrototype(object): boolean {\n  if (!object) {\n    return false;\n  }\n  // $FlowFixMe\n  const ObjectPrototype = Object.prototype;\n  if (object === ObjectPrototype) {\n    return true;\n  }\n  // It might be an object from a different Realm which is\n  // still just a plain simple object.\n  if (Object.getPrototypeOf(object)) {\n    return false;\n  }\n  const names = Object.getOwnPropertyNames(object);\n  for (let i = 0; i < names.length; i++) {\n    if (!(names[i] in ObjectPrototype)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction isSimpleObject(object): boolean {\n  if (!isObjectPrototype(Object.getPrototypeOf(object))) {\n    return false;\n  }\n  const names = Object.getOwnPropertyNames(object);\n  for (let i = 0; i < names.length; i++) {\n    const descriptor = Object.getOwnPropertyDescriptor(object, names[i]);\n    if (!descriptor) {\n      return false;\n    }\n    if (!descriptor.enumerable) {\n      if (\n        (names[i] === 'key' || names[i] === 'ref') &&\n        typeof descriptor.get === 'function'\n      ) {\n        // React adds key and ref getters to props objects to issue warnings.\n        // Those getters will not be transferred to the client, but that's ok,\n        // so we'll special case them.\n        continue;\n      }\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction objectName(object): string {\n  const name = Object.prototype.toString.call(object);\n  return name.replace(/^\\[object (.*)\\]$/, function(m, p0) {\n    return p0;\n  });\n}\n\nfunction describeKeyForErrorMessage(key: string): string {\n  const encodedKey = JSON.stringify(key);\n  return '\"' + key + '\"' === encodedKey ? key : encodedKey;\n}\n\nfunction describeValueForErrorMessage(value: ReactModel): string {\n  switch (typeof value) {\n    case 'string': {\n      return JSON.stringify(\n        value.length <= 10 ? value : value.substr(0, 10) + '...',\n      );\n    }\n    case 'object': {\n      if (isArray(value)) {\n        return '[...]';\n      }\n      const name = objectName(value);\n      if (name === 'Object') {\n        return '{...}';\n      }\n      return name;\n    }\n    case 'function':\n      return 'function';\n    default:\n      // eslint-disable-next-line\n      return String(value);\n  }\n}\n\nfunction describeObjectForErrorMessage(\n  objectOrArray:\n    | {+[key: string | number]: ReactModel}\n    | $ReadOnlyArray<ReactModel>,\n  expandedName?: string,\n): string {\n  if (isArray(objectOrArray)) {\n    let str = '[';\n    // $FlowFixMe: Should be refined by now.\n    const array: $ReadOnlyArray<ReactModel> = objectOrArray;\n    for (let i = 0; i < array.length; i++) {\n      if (i > 0) {\n        str += ', ';\n      }\n      if (i > 6) {\n        str += '...';\n        break;\n      }\n      const value = array[i];\n      if (\n        '' + i === expandedName &&\n        typeof value === 'object' &&\n        value !== null\n      ) {\n        str += describeObjectForErrorMessage(value);\n      } else {\n        str += describeValueForErrorMessage(value);\n      }\n    }\n    str += ']';\n    return str;\n  } else {\n    let str = '{';\n    // $FlowFixMe: Should be refined by now.\n    const object: {+[key: string | number]: ReactModel} = objectOrArray;\n    const names = Object.keys(object);\n    for (let i = 0; i < names.length; i++) {\n      if (i > 0) {\n        str += ', ';\n      }\n      if (i > 6) {\n        str += '...';\n        break;\n      }\n      const name = names[i];\n      str += describeKeyForErrorMessage(name) + ': ';\n      const value = object[name];\n      if (\n        name === expandedName &&\n        typeof value === 'object' &&\n        value !== null\n      ) {\n        str += describeObjectForErrorMessage(value);\n      } else {\n        str += describeValueForErrorMessage(value);\n      }\n    }\n    str += '}';\n    return str;\n  }\n}\n\nexport function resolveModelToJSON(\n  request: Request,\n  parent: {+[key: string | number]: ReactModel} | $ReadOnlyArray<ReactModel>,\n  key: string,\n  value: ReactModel,\n): ReactJSONValue {\n  if (__DEV__) {\n    // $FlowFixMe\n    const originalValue = parent[key];\n    if (typeof originalValue === 'object' && originalValue !== value) {\n      console.error(\n        'Only plain objects can be passed to client components from server components. ' +\n          'Objects with toJSON methods are not supported. Convert it manually ' +\n          'to a simple value before passing it to props. ' +\n          'Remove %s from these props: %s',\n        describeKeyForErrorMessage(key),\n        describeObjectForErrorMessage(parent),\n      );\n    }\n  }\n\n  // Special Symbols\n  switch (value) {\n    case REACT_ELEMENT_TYPE:\n      return '$';\n    case REACT_LAZY_TYPE:\n      invariant(\n        false,\n        'React Lazy Components are not yet supported on the server.',\n      );\n  }\n\n  // Resolve server components.\n  while (\n    typeof value === 'object' &&\n    value !== null &&\n    value.$$typeof === REACT_ELEMENT_TYPE\n  ) {\n    // TODO: Concatenate keys of parents onto children.\n    const element: React$Element<any> = (value: any);\n    try {\n      // Attempt to render the server component.\n      value = attemptResolveElement(\n        element.type,\n        element.key,\n        element.ref,\n        element.props,\n      );\n    } catch (x) {\n      if (typeof x === 'object' && x !== null && typeof x.then === 'function') {\n        // Something suspended, we'll need to create a new segment and resolve it later.\n        request.pendingChunks++;\n        const newSegment = createSegment(request, value);\n        const ping = newSegment.ping;\n        x.then(ping, ping);\n        return serializeByRefID(newSegment.id);\n      } else {\n        reportError(request, x);\n        // Something errored. We'll still send everything we have up until this point.\n        // We'll replace this element with a lazy reference that throws on the client\n        // once it gets rendered.\n        request.pendingChunks++;\n        const errorId = request.nextChunkId++;\n        emitErrorChunk(request, errorId, x);\n        return serializeByRefID(errorId);\n      }\n    }\n  }\n\n  if (value === null) {\n    return null;\n  }\n\n  if (typeof value === 'object') {\n    if (isModuleReference(value)) {\n      const moduleReference: ModuleReference<any> = (value: any);\n      const moduleKey: ModuleKey = getModuleKey(moduleReference);\n      const writtenModules = request.writtenModules;\n      const existingId = writtenModules.get(moduleKey);\n      if (existingId !== undefined) {\n        if (parent[0] === REACT_ELEMENT_TYPE && key === '1') {\n          // If we're encoding the \"type\" of an element, we can refer\n          // to that by a lazy reference instead of directly since React\n          // knows how to deal with lazy values. This lets us suspend\n          // on this component rather than its parent until the code has\n          // loaded.\n          return serializeByRefID(existingId);\n        }\n        return serializeByValueID(existingId);\n      }\n      try {\n        const moduleMetaData: ModuleMetaData = resolveModuleMetaData(\n          request.bundlerConfig,\n          moduleReference,\n        );\n        request.pendingChunks++;\n        const moduleId = request.nextChunkId++;\n        emitModuleChunk(request, moduleId, moduleMetaData);\n        writtenModules.set(moduleKey, moduleId);\n        if (parent[0] === REACT_ELEMENT_TYPE && key === '1') {\n          // If we're encoding the \"type\" of an element, we can refer\n          // to that by a lazy reference instead of directly since React\n          // knows how to deal with lazy values. This lets us suspend\n          // on this component rather than its parent until the code has\n          // loaded.\n          return serializeByRefID(moduleId);\n        }\n        return serializeByValueID(moduleId);\n      } catch (x) {\n        request.pendingChunks++;\n        const errorId = request.nextChunkId++;\n        emitErrorChunk(request, errorId, x);\n        return serializeByValueID(errorId);\n      }\n    }\n\n    if (__DEV__) {\n      if (value !== null && !isArray(value)) {\n        // Verify that this is a simple plain object.\n        if (objectName(value) !== 'Object') {\n          console.error(\n            'Only plain objects can be passed to client components from server components. ' +\n              'Built-ins like %s are not supported. ' +\n              'Remove %s from these props: %s',\n            objectName(value),\n            describeKeyForErrorMessage(key),\n            describeObjectForErrorMessage(parent),\n          );\n        } else if (!isSimpleObject(value)) {\n          console.error(\n            'Only plain objects can be passed to client components from server components. ' +\n              'Classes or other objects with methods are not supported. ' +\n              'Remove %s from these props: %s',\n            describeKeyForErrorMessage(key),\n            describeObjectForErrorMessage(parent, key),\n          );\n        } else if (Object.getOwnPropertySymbols) {\n          const symbols = Object.getOwnPropertySymbols(value);\n          if (symbols.length > 0) {\n            console.error(\n              'Only plain objects can be passed to client components from server components. ' +\n                'Objects with symbol properties like %s are not supported. ' +\n                'Remove %s from these props: %s',\n              symbols[0].description,\n              describeKeyForErrorMessage(key),\n              describeObjectForErrorMessage(parent, key),\n            );\n          }\n        }\n      }\n    }\n    return value;\n  }\n\n  if (typeof value === 'string') {\n    return escapeStringValue(value);\n  }\n\n  if (\n    typeof value === 'boolean' ||\n    typeof value === 'number' ||\n    typeof value === 'undefined'\n  ) {\n    return value;\n  }\n\n  if (typeof value === 'function') {\n    if (/^on[A-Z]/.test(key)) {\n      invariant(\n        false,\n        'Event handlers cannot be passed to client component props. ' +\n          'Remove %s from these props if possible: %s\\n' +\n          'If you need interactivity, consider converting part of this to a client component.',\n        describeKeyForErrorMessage(key),\n        describeObjectForErrorMessage(parent),\n      );\n    } else {\n      invariant(\n        false,\n        'Functions cannot be passed directly to client components ' +\n          \"because they're not serializable. \" +\n          'Remove %s (%s) from this object, or avoid the entire object: %s',\n        describeKeyForErrorMessage(key),\n        value.displayName || value.name || 'function',\n        describeObjectForErrorMessage(parent),\n      );\n    }\n  }\n\n  if (typeof value === 'symbol') {\n    const writtenSymbols = request.writtenSymbols;\n    const existingId = writtenSymbols.get(value);\n    if (existingId !== undefined) {\n      return serializeByValueID(existingId);\n    }\n    const name = value.description;\n    invariant(\n      Symbol.for(name) === value,\n      'Only global symbols received from Symbol.for(...) can be passed to client components. ' +\n        'The symbol Symbol.for(%s) cannot be found among global symbols. ' +\n        'Remove %s from this object, or avoid the entire object: %s',\n      value.description,\n      describeKeyForErrorMessage(key),\n      describeObjectForErrorMessage(parent),\n    );\n    request.pendingChunks++;\n    const symbolId = request.nextChunkId++;\n    emitSymbolChunk(request, symbolId, name);\n    writtenSymbols.set(value, symbolId);\n    return serializeByValueID(symbolId);\n  }\n\n  // $FlowFixMe: bigint isn't added to Flow yet.\n  if (typeof value === 'bigint') {\n    invariant(\n      false,\n      'BigInt (%s) is not yet supported in client component props. ' +\n        'Remove %s from this object or use a plain number instead: %s',\n      value,\n      describeKeyForErrorMessage(key),\n      describeObjectForErrorMessage(parent),\n    );\n  }\n\n  invariant(\n    false,\n    'Type %s is not supported in client component props. ' +\n      'Remove %s from this object, or avoid the entire object: %s',\n    typeof value,\n    describeKeyForErrorMessage(key),\n    describeObjectForErrorMessage(parent),\n  );\n}\n\nfunction reportError(request: Request, error: mixed): void {\n  const onError = request.onError;\n  onError(error);\n}\n\nfunction fatalError(request: Request, error: mixed): void {\n  // This is called outside error handling code such as if an error happens in React internals.\n  closeWithError(request.destination, error);\n}\n\nfunction emitErrorChunk(request: Request, id: number, error: mixed): void {\n  // TODO: We should not leak error messages to the client in prod.\n  // Give this an error code instead and log on the server.\n  // We can serialize the error in DEV as a convenience.\n  let message;\n  let stack = '';\n  try {\n    if (error instanceof Error) {\n      message = '' + error.message;\n      stack = '' + error.stack;\n    } else {\n      message = 'Error: ' + (error: any);\n    }\n  } catch (x) {\n    message = 'An error occurred but serializing the error message failed.';\n  }\n\n  const processedChunk = processErrorChunk(request, id, message, stack);\n  request.completedErrorChunks.push(processedChunk);\n}\n\nfunction emitModuleChunk(\n  request: Request,\n  id: number,\n  moduleMetaData: ModuleMetaData,\n): void {\n  const processedChunk = processModuleChunk(request, id, moduleMetaData);\n  request.completedModuleChunks.push(processedChunk);\n}\n\nfunction emitSymbolChunk(request: Request, id: number, name: string): void {\n  const processedChunk = processSymbolChunk(request, id, name);\n  request.completedModuleChunks.push(processedChunk);\n}\n\nfunction retrySegment(request: Request, segment: Segment): void {\n  try {\n    let value = segment.model;\n    while (\n      typeof value === 'object' &&\n      value !== null &&\n      value.$$typeof === REACT_ELEMENT_TYPE\n    ) {\n      // TODO: Concatenate keys of parents onto children.\n      const element: React$Element<any> = (value: any);\n      // Attempt to render the server component.\n      // Doing this here lets us reuse this same segment if the next component\n      // also suspends.\n      segment.model = value;\n      value = attemptResolveElement(\n        element.type,\n        element.key,\n        element.ref,\n        element.props,\n      );\n    }\n    const processedChunk = processModelChunk(request, segment.id, value);\n    request.completedJSONChunks.push(processedChunk);\n  } catch (x) {\n    if (typeof x === 'object' && x !== null && typeof x.then === 'function') {\n      // Something suspended again, let's pick it back up later.\n      const ping = segment.ping;\n      x.then(ping, ping);\n      return;\n    } else {\n      reportError(request, x);\n      // This errored, we need to serialize this error to the\n      emitErrorChunk(request, segment.id, x);\n    }\n  }\n}\n\nfunction performWork(request: Request): void {\n  const prevDispatcher = ReactCurrentDispatcher.current;\n  const prevCache = currentCache;\n  ReactCurrentDispatcher.current = Dispatcher;\n  currentCache = request.cache;\n\n  try {\n    const pingedSegments = request.pingedSegments;\n    request.pingedSegments = [];\n    for (let i = 0; i < pingedSegments.length; i++) {\n      const segment = pingedSegments[i];\n      retrySegment(request, segment);\n    }\n    if (request.flowing) {\n      flushCompletedChunks(request);\n    }\n  } catch (error) {\n    reportError(request, error);\n    fatalError(request, error);\n  } finally {\n    ReactCurrentDispatcher.current = prevDispatcher;\n    currentCache = prevCache;\n  }\n}\n\nlet reentrant = false;\nfunction flushCompletedChunks(request: Request): void {\n  if (reentrant) {\n    return;\n  }\n  reentrant = true;\n  const destination = request.destination;\n  beginWriting(destination);\n  try {\n    // We emit module chunks first in the stream so that\n    // they can be preloaded as early as possible.\n    const moduleChunks = request.completedModuleChunks;\n    let i = 0;\n    for (; i < moduleChunks.length; i++) {\n      request.pendingChunks--;\n      const chunk = moduleChunks[i];\n      if (!writeChunk(destination, chunk)) {\n        request.flowing = false;\n        i++;\n        break;\n      }\n    }\n    moduleChunks.splice(0, i);\n    // Next comes model data.\n    const jsonChunks = request.completedJSONChunks;\n    i = 0;\n    for (; i < jsonChunks.length; i++) {\n      request.pendingChunks--;\n      const chunk = jsonChunks[i];\n      if (!writeChunk(destination, chunk)) {\n        request.flowing = false;\n        i++;\n        break;\n      }\n    }\n    jsonChunks.splice(0, i);\n    // Finally, errors are sent. The idea is that it's ok to delay\n    // any error messages and prioritize display of other parts of\n    // the page.\n    const errorChunks = request.completedErrorChunks;\n    i = 0;\n    for (; i < errorChunks.length; i++) {\n      request.pendingChunks--;\n      const chunk = errorChunks[i];\n      if (!writeChunk(destination, chunk)) {\n        request.flowing = false;\n        i++;\n        break;\n      }\n    }\n    errorChunks.splice(0, i);\n  } finally {\n    reentrant = false;\n    completeWriting(destination);\n  }\n  flushBuffered(destination);\n  if (request.pendingChunks === 0) {\n    // We're done.\n    close(destination);\n  }\n}\n\nexport function startWork(request: Request): void {\n  request.flowing = true;\n  scheduleWork(() => performWork(request));\n}\n\nexport function startFlowing(request: Request): void {\n  request.flowing = true;\n  try {\n    flushCompletedChunks(request);\n  } catch (error) {\n    reportError(request, error);\n    fatalError(request, error);\n  }\n}\n\nfunction unsupportedHook(): void {\n  invariant(false, 'This Hook is not supported in Server Components.');\n}\n\nfunction unsupportedRefresh(): void {\n  invariant(\n    currentCache,\n    'Refreshing the cache is not supported in Server Components.',\n  );\n}\n\nlet currentCache: Map<Function, mixed> | null = null;\n\nconst Dispatcher: DispatcherType = {\n  useMemo<T>(nextCreate: () => T): T {\n    return nextCreate();\n  },\n  useCallback<T>(callback: T): T {\n    return callback;\n  },\n  useDebugValue(): void {},\n  useDeferredValue: (unsupportedHook: any),\n  useTransition: (unsupportedHook: any),\n  getCacheForType<T>(resourceType: () => T): T {\n    invariant(\n      currentCache,\n      'Reading the cache is only supported while rendering.',\n    );\n    let entry: T | void = (currentCache.get(resourceType): any);\n    if (entry === undefined) {\n      entry = resourceType();\n      // TODO: Warn if undefined?\n      currentCache.set(resourceType, entry);\n    }\n    return entry;\n  },\n  readContext: (unsupportedHook: any),\n  useContext: (unsupportedHook: any),\n  useReducer: (unsupportedHook: any),\n  useRef: (unsupportedHook: any),\n  useState: (unsupportedHook: any),\n  useLayoutEffect: (unsupportedHook: any),\n  useImperativeHandle: (unsupportedHook: any),\n  useEffect: (unsupportedHook: any),\n  useOpaqueIdentifier: (unsupportedHook: any),\n  useMutableSource: (unsupportedHook: any),\n  useSyncExternalStore: (unsupportedHook: any),\n  useCacheRefresh(): <T>(?() => T, ?T) => void {\n    return unsupportedRefresh;\n  },\n};\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {ReactModel} from 'react-server/src/ReactFlightServer';\nimport type {\n  BundlerConfig,\n  Destination,\n} from './ReactFlightNativeRelayServerHostConfig';\n\nimport {createRequest, startWork} from 'react-server/src/ReactFlightServer';\n\nfunction render(\n  model: ReactModel,\n  destination: Destination,\n  config: BundlerConfig,\n): void {\n  const request = createRequest(model, destination, config);\n  startWork(request);\n}\n\nexport {render};\n"],"names":["ReactSharedInternals","React","error","format","args","printWarning","level","ReactDebugCurrentFrame","stack","getStackAddendum","concat","argsWithFormat","map","item","unshift","Function","prototype","apply","call","console","hasOwnProperty","Object","isArrayImpl","Array","isArray","a","isModuleReference","reference","JSResourceReferenceImpl","getModuleKey","resolveModuleMetaData","config","resource","resolveModuleMetaDataImpl","processErrorChunk","request","id","message","convertModelToJSON","parent","key","model","json","resolveModelToJSON","jsonArray","i","length","jsonObj","nextKey","processModelChunk","processModuleChunk","moduleMetaData","processSymbolChunk","name","scheduleWork","callback","writeChunk","destination","chunk","emitRow","closeWithError","close","REACT_ELEMENT_TYPE","REACT_PORTAL_TYPE","REACT_FRAGMENT_TYPE","REACT_STRICT_MODE_TYPE","REACT_PROFILER_TYPE","REACT_PROVIDER_TYPE","REACT_CONTEXT_TYPE","REACT_FORWARD_REF_TYPE","REACT_SUSPENSE_TYPE","REACT_SUSPENSE_LIST_TYPE","REACT_MEMO_TYPE","REACT_LAZY_TYPE","REACT_SCOPE_TYPE","REACT_OPAQUE_ID_TYPE","REACT_DEBUG_TRACING_MODE_TYPE","REACT_OFFSCREEN_TYPE","REACT_LEGACY_HIDDEN_TYPE","REACT_CACHE_TYPE","Symbol","for","symbolFor","ReactCurrentDispatcher","defaultErrorHandler","createRequest","bundlerConfig","onError","pingedSegments","cache","Map","nextChunkId","pendingChunks","completedModuleChunks","completedJSONChunks","completedErrorChunks","writtenSymbols","writtenModules","undefined","flowing","toJSON","value","rootSegment","createSegment","push","attemptResolveElement","type","ref","props","children","$$typeof","render","describeValueForErrorMessage","pingSegment","segment","performWork","ping","serializeByValueID","toString","serializeByRefID","escapeStringValue","isObjectPrototype","object","ObjectPrototype","getPrototypeOf","names","getOwnPropertyNames","isSimpleObject","descriptor","getOwnPropertyDescriptor","enumerable","get","objectName","replace","m","p0","describeKeyForErrorMessage","encodedKey","JSON","stringify","substr","String","describeObjectForErrorMessage","objectOrArray","expandedName","str","array","keys","originalValue","element","x","then","newSegment","reportError","errorId","emitErrorChunk","moduleReference","moduleKey","existingId","moduleId","emitModuleChunk","set","getOwnPropertySymbols","symbols","description","test","displayName","symbolId","emitSymbolChunk","fatalError","Error","processedChunk","retrySegment","prevDispatcher","current","prevCache","currentCache","Dispatcher","flushCompletedChunks","reentrant","beginWriting","moduleChunks","splice","jsonChunks","errorChunks","completeWriting","startWork","unsupportedHook","unsupportedRefresh","useMemo","nextCreate","useCallback","useDebugValue","useDeferredValue","useTransition","getCacheForType","resourceType","entry","readContext","useContext","useReducer","useRef","useState","useLayoutEffect","useImperativeHandle","useEffect","useOpaqueIdentifier","useMutableSource","useSyncExternalStore","useCacheRefresh"],"mappings":"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"}